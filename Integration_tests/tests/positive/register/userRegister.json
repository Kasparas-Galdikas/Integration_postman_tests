{
  "info": {
    "name": "positive - register - userRegister",
    "_postman_id": "pos-register-single-test",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Pozityvus registracijos testas: tikrina statusƒÖ, JSON formatƒÖ, atsakymo strukt≈´rƒÖ, laukus, slapt≈≥ lauk≈≥ nebuvimƒÖ ir kad vartotojas realiai i≈°saugotas (per GET)."
  },
  "item": [
    {
      "name": "Registracija ‚Äì sƒókmƒó (POST /register)",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// üîß Sugeneruojame unikalias reik≈°mes, kad testas b≈´t≈≥ kartotinas",
              "const id = Date.now();",
              "pm.collectionVariables.set('regUsername', `user_pos_reg_${id}`);",
              "pm.collectionVariables.set('regFullName', 'User Positive Register');",
              "pm.collectionVariables.set('regEmail', `posreg_${id}@example.com`);",
              "pm.collectionVariables.set('regPassword', 'secret1');",
              "",
              "// Jei nƒóra baseUrl, numatytai nustatome ƒØ localhost",
              "if (!pm.environment.get('baseUrl') && !pm.collectionVariables.get('baseUrl')) {",
              "  pm.collectionVariables.set('baseUrl', 'http://localhost:3000');",
              "}"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// 1) Status kodas",
              "pm.test('Status 201 (sukurta)', () => pm.response.to.have.status(201));",
              "",
              "// 2) JSON formatas (leid≈æia ; charset=utf-8)",
              "pm.test('Content-Type yra JSON', () => {",
              "  const ctype = pm.response.headers.get('Content-Type');",
              "  pm.expect(ctype).to.match(/^application\\/json\\b/i);",
              "});",
              "const body = pm.response.json();",
              "",
              "// 3) NumatytƒÖ strukt≈´rƒÖ (message, user)",
              "pm.test('Atsakymas turi message ir user laukus', () => {",
              "  pm.expect(body).to.have.property('message');",
              "  pm.expect(body).to.have.property('user');",
              "});",
              "",
              "// 4) Duomen≈≥ laukai (username, email, fullName) ir joki≈≥ slapta≈æod≈æi≈≥",
              "pm.test('User turi username/email/fullName ir neturi password', () => {",
              "  pm.expect(body.user).to.have.property('username');",
              "  pm.expect(body.user).to.have.property('email');",
              "  pm.expect(body.user).to.have.property('fullName');",
              "  pm.expect(body.user).to.not.have.property('password');",
              "});",
              "",
              "// 5) Reik≈°mƒós sutampa su si≈≥stomis",
              "pm.test('GrƒÖ≈æintos reik≈°mƒós sutampa su si≈≥stomis', () => {",
              "  pm.expect(body.user.username).to.eql(pm.collectionVariables.get('regUsername'));",
              "  pm.expect(body.user.email).to.eql(pm.collectionVariables.get('regEmail'));",
              "  pm.expect(body.user.fullName).to.eql(pm.collectionVariables.get('regFullName'));",
              "});",
              "",
              "// 6) Teisingas endpoint (saugumo testas ‚Äì tikriname, kad kelias yra /register)",
              "pm.test('Naudojamas teisingas endpoint (/register)', () => {",
              "  const path = pm.request.url.getPath();",
              "  pm.expect(path).to.match(/\\/register$/);",
              "});",
              "",
              "// 7) Patikriname, kad vartotojas tikrai i≈°saugotas (per GET /user/:username)",
              "const base = pm.environment.get('baseUrl') || pm.collectionVariables.get('baseUrl');",
              "const u = pm.collectionVariables.get('regUsername');",
              "pm.sendRequest({",
              "  url: `${base}/user/${u}`,",
              "  method: 'GET'",
              "}, (err, res) => {",
              "  pm.test('Po registracijos ‚Äì GET /user/:username grƒÖ≈æina 200', () => {",
              "    pm.expect(err).to.be.null;",
              "    pm.expect(res).to.have.property('code', 200);",
              "  });",
              "  pm.test('GET atsakymas yra JSON', () => {",
              "    pm.expect(res.headers.get('Content-Type')).to.match(/application\\/json/i);",
              "  });",
              "  const j = res.json();",
              "  pm.test('GET grƒÖ≈æina laukus ir nƒóra password', () => {",
              "    pm.expect(j).to.have.property('username');",
              "    pm.expect(j).to.have.property('email');",
              "    pm.expect(j).to.have.property('fullName');",
              "    pm.expect(j).to.not.have.property('password');",
              "  });",
              "  pm.test('GET reik≈°mƒós sutampa su registruotomis', () => {",
              "    pm.expect(j.username).to.eql(pm.collectionVariables.get('regUsername'));",
              "    pm.expect(j.email).to.eql(pm.collectionVariables.get('regEmail'));",
              "    pm.expect(j.fullName).to.eql(pm.collectionVariables.get('regFullName'));",
              "  });",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/register",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "register"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"username\": \"{{regUsername}}\",\n  \"fullName\": \"{{regFullName}}\",\n  \"email\": \"{{regEmail}}\",\n  \"password\": \"{{regPassword}}\"\n}"
        },
        "description": "Pozityvus registracijos testas su papildomu GET patvirtinimu, kad vartotojas tikrai i≈°saugotas."
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000"
    }
  ]
}